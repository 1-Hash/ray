language: python

python:
  - 2.7

before_install:
    - pip install coveralls
    - pip install python-coveralls

script:
    - pip install -r onhands-core/requirements.txt

    # onhands-sqlalchemy build
    - cd onhands-sqlalchemy/
    - pip install --editable .
    - pip install requests
    - cd tests/
    - onhands up --wsgifile app.py &
    - sleep 2
    - py.test test_integrated.py

    # onhands-core build
    - cd ../onhands-core
    - pip install --editable .
    - py.test -v tests/ --cov onhands


after_success:
  - coveralls

notifications:
    email:
        recipients:
            - felipevolpone@gmail.com
        on_success: change
        on_failure: always
